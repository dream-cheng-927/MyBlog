(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-409c86af"],{1511:function(e,t,r){"use strict";r.r(t);var a=r("7a23");Object(a["N"])("data-v-32ede052");var s={id:"User"},n=Object(a["n"])("h2",null,"修改用户名",-1),c=Object(a["n"])("h2",null,"修改密码",-1),u=Object(a["n"])("h2",null,"头像上传",-1);function o(e,t,r,o,l,i){var b=Object(a["T"])("UpdateName"),d=Object(a["T"])("UpdatePass"),p=Object(a["T"])("UpdatePhoto");return Object(a["K"])(),Object(a["m"])("div",s,[Object(a["n"])("article",null,[n,Object(a["r"])(b)]),Object(a["n"])("article",null,[c,Object(a["r"])(d)]),Object(a["n"])("article",null,[u,Object(a["r"])(p)])])}Object(a["L"])();var l=r("5530");r("ac1f"),r("5319");Object(a["N"])("data-v-27089e47");var i={class:"UpdateName"},b={class:"code"},d=Object(a["q"])("确认修改");function p(e,t,r,s,n,c){var u=Object(a["T"])("el-form-item"),o=Object(a["T"])("el-input"),l=Object(a["T"])("el-button"),p=Object(a["T"])("el-form");return Object(a["K"])(),Object(a["m"])("div",i,[Object(a["r"])(p,{model:n.userForm,"status-icon":"",rules:n.rules,ref:"userForm","label-width":"100px"},{default:Object(a["ib"])((function(){return[Object(a["r"])(u,{label:"当前用户名：","label-width":"100px"},{default:Object(a["ib"])((function(){return[Object(a["n"])("span",b,Object(a["X"])(e.userInfo.user),1)]})),_:1}),Object(a["r"])(u,{label:"新用户名：",prop:"user","label-width":"100px"},{default:Object(a["ib"])((function(){return[Object(a["r"])(o,{modelValue:n.userForm.user,"onUpdate:modelValue":t[0]||(t[0]=function(e){return n.userForm.user=e})},null,8,["modelValue"])]})),_:1}),Object(a["r"])(u,{"label-width":"100px"},{default:Object(a["ib"])((function(){return[Object(a["r"])(l,{type:"primary",onClick:c.submit},{default:Object(a["ib"])((function(){return[d]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model","rules"])])}Object(a["L"])();var m=r("1da1"),f=(r("96cf"),r("5502")),O={name:"UpdateName",data:function(){var e=this;return{userForm:{user:""},rules:{user:[{validator:function(t,r,a){(r.length<2||r.length>8)&&a(new Error("请输入2~8位的用户名")),/^[\w\u4e00-\u9fa5\u0800-\u4e00\uac00-\ud7ff]+$/.test(r)||a(new Error("只允许 数字 字母 _ 中/日/韩文")),r===e.userInfo.user&&a(new Error("用户名没有变化...")),a()}}]}}},computed:Object(l["a"])({},Object(f["c"])(["userInfo"])),methods:Object(l["a"])(Object(l["a"])({},Object(f["b"])(["loginSuccess"])),{},{submit:function(){var e=this;this.$refs.userForm.validate(function(){var t=Object(m["a"])(regeneratorRuntime.mark((function t(r){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=12;break}return t.next=3,e.$axios({method:"POST",url:"/personal/user",data:{user:e.userForm.user}});case 3:if(a=t.sent,s=a.data,!s.code){t.next=7;break}return t.abrupt("return",e.$message.error(s.msg));case 7:e.$message.success("用户名修改成功"),e.loginSuccess(s.data),e.$refs.userForm.resetFields(),t.next=13;break;case 12:return t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}})};r("50e5");O.render=p,O.__scopeId="data-v-27089e47";var j=O,h={id:"UpdatePass"},v=Object(a["q"])("确认修改");function w(e,t,r,s,n,c){var u=Object(a["T"])("el-input"),o=Object(a["T"])("el-form-item"),l=Object(a["T"])("el-button"),i=Object(a["T"])("el-form");return Object(a["K"])(),Object(a["m"])("div",h,[Object(a["r"])(i,{model:n.passForm,"status-icon":"",rules:n.rules,ref:"passForm","label-width":"100px"},{default:Object(a["ib"])((function(){return[Object(a["r"])(o,{label:"原密码：",prop:"pass","label-width":"100px"},{default:Object(a["ib"])((function(){return[Object(a["r"])(u,{type:"password",modelValue:n.passForm.oldPass,"onUpdate:modelValue":t[0]||(t[0]=function(e){return n.passForm.oldPass=e})},null,8,["modelValue"])]})),_:1}),Object(a["r"])(o,{label:"新密码：",prop:"pass","label-width":"100px"},{default:Object(a["ib"])((function(){return[Object(a["r"])(u,{type:"password",modelValue:n.passForm.pass,"onUpdate:modelValue":t[1]||(t[1]=function(e){return n.passForm.pass=e})},null,8,["modelValue"])]})),_:1}),Object(a["r"])(o,{label:"确认新密码：",prop:"pass2","label-width":"100px"},{default:Object(a["ib"])((function(){return[Object(a["r"])(u,{type:"password",modelValue:n.passForm.pass2,"onUpdate:modelValue":t[2]||(t[2]=function(e){return n.passForm.pass2=e})},null,8,["modelValue"])]})),_:1}),Object(a["r"])(o,{"label-width":"100px"},{default:Object(a["ib"])((function(){return[Object(a["r"])(l,{type:"primary",onClick:c.submit},{default:Object(a["ib"])((function(){return[v]})),_:1},8,["onClick"])]})),_:1})]})),_:1},8,["model","rules"])])}var g={name:"UpdatePass",data:function(){var e=this;return{passForm:{oldPass:"",pass:"",pass2:""},rules:{pass:[{validator:function(e,t,r){(t.length<6||t.length>18)&&r(new Error("请输入6~18位的密码")),/^[\w\[\]\/\\~`|<>,.?;':"{}!@#$%^&*()_+=-]+$/.test(t)||r(new Error("不允许的密码字符")),r()},trigger:"input"}],pass2:[{validator:function(t,r,a){e.passForm.pass!==r&&a(new Error("两次输入密码不一致")),a()}}]}}},methods:Object(l["a"])(Object(l["a"])({},Object(f["b"])(["loginOut"])),{},{submit:function(){var e=this;this.$refs.passForm.validate(function(){var t=Object(m["a"])(regeneratorRuntime.mark((function t(r){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=13;break}return t.next=3,e.$axios({method:"POST",url:"/personal/pass",data:{oldPass:e.passForm.oldPass,pass:e.passForm.pass}});case 3:if(a=t.sent,s=a.data,!s.code){t.next=7;break}return t.abrupt("return",e.$message.error(s.msg));case 7:e.$message.success("密码修改成功，请重新登录"),e.loginOut(),e.$refs.passForm.resetFields(),e.$router.push("/"),t.next=14;break;case 13:return t.abrupt("return",!1);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}})};g.render=w;var U=g;Object(a["N"])("data-v-47ad9874");var F={id:"UpdatePhoto"},x=["src"],k={key:1,class:"el-icon-plus avatar-uploader-icon"};function $(e,t,r,s,n,c){var u=Object(a["T"])("el-alert"),o=Object(a["T"])("el-upload");return Object(a["K"])(),Object(a["m"])("div",F,[Object(a["r"])(u,{title:"上传头像",type:"warning",description:"点击下方 + 号上传并修改头像",closable:!1,"show-icon":""}),Object(a["r"])(o,{class:"avatar-uploader",action:e.baseURL+"/personal/photo","show-file-list":!1,"with-credentials":!0,"on-success":c.handleAvatarSuccess,"before-upload":c.beforeAvatarUpload},{default:Object(a["ib"])((function(){return[n.imageUrl?(Object(a["K"])(),Object(a["m"])("img",{key:0,src:n.imageUrl,class:"avatar"},null,8,x)):(Object(a["K"])(),Object(a["m"])("i",k))]})),_:1},8,["action","on-success","before-upload"])])}Object(a["L"])();r("d3b7"),r("3ca3"),r("ddb0"),r("2b3d");var _={name:"UpdatePhoto",data:function(){return{imageUrl:""}},methods:Object(l["a"])(Object(l["a"])({},Object(f["b"])(["loginSuccess"])),{},{handleAvatarSuccess:function(e,t){if(e.code)return this.$message.error("上传失败，是稍后再试");this.imageUrl=URL.createObjectURL(t.raw),this.loginSuccess(e.data)},beforeAvatarUpload:function(e){var t=/^image\/(jpeg|png)$/.test(e.type),r=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG/PNG 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&r}})};r("63e6");_.render=$,_.__scopeId="data-v-47ad9874";var P=_,T={name:"User",components:{UpdateName:j,UpdatePass:U,UpdatePhoto:P},computed:Object(l["a"])({},Object(f["c"])(["userInfo"])),watch:{userInfo:function(){this.backHome()}},methods:{backHome:function(){this.userInfo.user||(this.$message.error("当前未登录，无法修改个人信息，已自动返回首页"),this.$router.replace("/"))}},beforeRouteEnter:function(e,t,r){r((function(e){e.backHome()}))}};r("8611");T.render=o,T.__scopeId="data-v-32ede052";t["default"]=T},"50e5":function(e,t,r){"use strict";r("5951")},5951:function(e,t,r){},"63e6":function(e,t,r){"use strict";r("7294")},7294:function(e,t,r){},8611:function(e,t,r){"use strict";r("dfbc")},dfbc:function(e,t,r){}}]);
//# sourceMappingURL=chunk-409c86af.6774f760.js.map